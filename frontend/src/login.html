---
layout: prime_page.liquid
title: "Login"
cdn_styles:
  - href: "https://global.oktacdn.com/okta-signin-widget/5.2.1/css/okta-sign-in.min.css"
    integrity: "sha384-NHrrVHQI7Uja/X0/0SMVLSk+nFzWI8AwBi1LqSOu7PogLHanNl0fOq1tTdvgb9C7"

cdn_scripts:
  - src: "https://global.oktacdn.com/okta-signin-widget/5.2.1/js/okta-sign-in.min.js"
    integrity: "sha384-pVjuWLMDJj0Bp6nDaWi8nJtFz+GfVP3hxebF4f6z81KDsRK/+DfCoLK/6ZjHWaoh"

local_styles:
  - "./css/prime.css"
---

{% include header_gov_website %}

<main>
  <div id="okta-login-container"></div>
</main>

<script type=module>
  import prime_api from '/js/prime_api.mjs'

  let config = {
    logo: '//logo.clearbit.com/cdc.gov',
    language: 'en',
    features: {
      registration: false, // Enable self-service registration flow
      rememberMe: false, // Setting to false will remove the checkbox to save username
      router: true, // Leave this set to true for the API demo
    },
    el: "#okta-login-container",
    baseUrl: "https://{{ env.OKTA_baseUrl }}",
    clientId: "{{ env.OKTA_clientId }}",
    redirectUri: "{{ env.OKTA_redirect }}",
    authParams: {
      issuer: "https://{{ env.OKTA_baseUrl }}/oauth2/default"
    }
  };
  
  let signInWidget = new OktaSignIn(config);
  signInWidget
    .showSignInToGetTokens( { scopes: ['openid', 'email', 'profile', 'simple_report'] } )
    .then( tokens => prime_api.jwt_login(tokens.accessToken.value))
    .then( () => window.location.replace({{"/" | url | as_literal }}) )
</script>

{% include devel_tools %}
